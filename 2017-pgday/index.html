<!DOCTYPE html>
<html lang="en">
<head>
    <title>A Bit About ClickHouse</title>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta property="og:image" content="pictures/preview.png">
    <meta property="og:title" content="A Bit About ClickHouse">
    <meta property="og:type" content="website">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="pictures/preview.png">
    <link rel="stylesheet" href="shower/themes/ribbon/styles/screen-16x10.css">

<!--    <style type="text/css">
         span { padding: 1px 10px; background: rgba(255, 255, 255, 0.75); }
    </style>-->
</head>
<body class="shower list">
    <header class="caption">
        <h1>A Bit About ClickHouse</h1>
    </header>
    <section class="slide" id="cover">
        <h1 style="margin-top: 100px"><span>PG Day 2017</span></h1>
        <h1><span>A Bit About ClickHouse</span></h1>
    </section>
    <section class="slide">
        <h2>About Me</h2>
        <p>Alexey, ClickHouse developer.</p>
        <p>Since 2008, I've been working on the data processing engine for Yandex.Metrica.</p>
    </section>
    <section class="slide">
        <h2>History</h2>
        <p>Yandex.Metrica is a web analytics service.</p>
        <p>First in Russia, second in the world.</p>
        <p><img src="pictures/metrika_market_share.png"/></p>
        <p>About ~25 billion events arrive daily.</p>
        <p>We need to show reports in real time.</p>
    </section>
    <section class="slide">
        <h2>Old Metrica (2008–2014)</h2>
        <p>Everything worked great. Users could get about 50 different reports.</p>
        <p>But there's a problem. We wanted more. For each report to be arbitrarily customizable.</p>
    </section>
    <section class="slide">
        <h2>Report Builder</h2>
        <p>We quickly made a prototype and implemented a "Report Builder" based on it.</p>
        <p>This was in 2010.</p>
        <p>It became clear where to move forward. </p>
        <p>We needed a good column-oriented DBMS.</p>
    </section>
    <section class="slide">
        <h2>Why Column-Oriented?</h2>
        <p>This is how row-oriented systems work:</p>
        <p><img src="pictures/row_oriented.gif"/></p>
    </section>
    <section class="slide">
        <h2>Why Column-Oriented?</h2>
        <p>This is how column-oriented systems work:</p>
        <p><img src="pictures/column_oriented.gif"/></p>
    </section>
    <section class="slide">
        <h2>Why ClickHouse?</h2>
        <p>Nothing ready-made was suitable.</p>
        <p>So we made ClickHouse.</p>
        <p>"Evolution of Data Structures in Yandex.Metrica"</p>
        <p><a href="https://habrahabr.ru/company/yandex/blog/273305/">https://habrahabr.ru/company/yandex/blog/273305/</a></p>
    </section>
    <section class="slide">
        <h2>Metrica 2.0</h2>
        <img src="pictures/metrika2.png" style="height:70%"/>
    </section>
    <section class="slide">
        <h2>In Brief</h2>
        <ul>
            <li>column-oriented</li>
            <li>linear scalability</li>
            <li>fault tolerance</li>
            <li>real-time data loading</li>
            <li>online (sub-second) queries</li>
            <li>support for SQL dialect + extensions<br/>(arrays, nested data structures, domain-specific functions, sampling)</li>
        </ul>
    </section>
    <section class="slide">
        <h2>Metrica's Main Cluster</h2>
        <ul style="font-size:30px;">
            <li>>23 trillion rows</li>
            <li>500 servers</li>
            <li>data processing speed up to two terabytes per second</li>
        </ul>
        <p style="font-size:60%; margin-top:2em">* If you want to try ClickHouse, one server is enough.</p>
    </section>
    <section class="slide">
        <h2>ClickHouse at Yandex</h2>
        <p>We managed to make a relatively convenient system.</p>
        <p>From the very beginning, we had detailed documentation.</p>
        <p>Within a couple of years, ClickHouse spread to other departments of Yandex.</p>
        <p>Mail, Market, Direct, Webmaster, AdFox, Infrastructure, Business Analytics...</p>
        <p>There are cases where analysts independently installed ClickHouse on virtual machines and successfully used it without any questions.</p>
    </section>
    <section class="slide">
        <h2>Open-Source</h2>
        <p>Then we decided — ClickHouse is too good a system for us to keep to ourselves.</p>
        <p>To make it more fun, we need to get people outside to use ClickHouse, let them enjoy it. We decided to make it open-source.</p>
    </section>
    <section class="slide">
        <h2>Open-Source</h2>
        <p>Apache 2.0 license — minimal restrictions.</p>
        <p>Goal — maximum product distribution.</p>
        <p>We want Yandex's product to be used worldwide.</p>
        <p>See "Yandex Opens ClickHouse"</p>
        <p><a href="https://habrahabr.ru/company/yandex/blog/303282/">https://habrahabr.ru/company/yandex/blog/303282/</a></p>
    </section>
    <section class="slide">
        <h2 style="font-size: 45px;"><span>When to Use ClickHouse</span></h2>
        <p><span>Well-structured, cleaned, immutable events.</span></p>
        <p>&nbsp;</p>
        <p><span>Click stream. Web analytics. Ad networks. RTB. E-commerce.</span></p>
        <p><span>Online game analytics. Sensor and monitoring data. Telecom data.</span></p>
        <p><span>Financial transactions. Stock market analytics.</span></p>
    </section>
    <section class="slide">
        <h2 style="font-size: 40px;"><span>When <span style="color:red;">Not to Use</span> ClickHouse</span></h2>
        <p><span style="font-size: 30px;color: #888;">OLTP</span><br/><span>ClickHouse has no UPDATE and full-fledged transactions.</span></p>
        <p><span style="font-size: 30px;color: #888;">Key-Value</span><br/><span>If you need frequent update queries by key, use another solution.</span></p>
        <p><span style="font-size: 30px;color: #888;">Blob-store, document oriented</span><br/><span>ClickHouse is intended for large amounts of fine-grained data.</span></p>
    </section>

<!-- Usages -->

    <section class="slide">
        <h2>ClickHouse Adoption</h2>

        <p>Hundreds of companies in Russia and nearby<br/>Yandex, Mail.ru, Rambler, SKB Kontur, SMI2&hellip;</p>
        <p>Dozens of companies in Europe, USA, China<br/>Cloudflare, Wikimedia, Lifestreet, Vertamedia, Carto, Nvidia, Infinidat&hellip;</p>
    </section>

    <section class="slide">
        <img style="width: 50%; margin-left: -13px;" src="pictures/cloudflare.svg"/>
        <p>How do we analyze over O(100B) DNS requests daily.</p>
        <p>"ClickHouse enables us and our customers to explore the dataset in real time to get operational insights. Due to many of the optimizations built into ClickHouse we are able to store the data for a long time allowing us to look at events in perspective and at historical trends."</p>
    </section>

    <section class="slide">
        <h2>Wikimedia.org</h2>
        <img style="float: right; width: 30%; padding-left: 30px;" src="pictures/wikimedia.svg"/>
        <p>"clickhouse is a columnar datastore that we are using as an aid to run complex SQL queries on the edit data "lake" that we have as a result of the edit reconstruction project. It is similar to Druid but faster for complex queries."</p>
        <p><a href="https://phabricator.wikimedia.org/T150343">https://phabricator.wikimedia.org/T150343</a></p>
    </section>

    <section class="slide">
        <h2 style="font-size: 30pt;">Unusual Examples of ClickHouse Use</h2>

        <p>Search engine and analytics for Bitcoin transactions:
        <br/><a href="https://blockchair.com/">https://blockchair.com/</a></p>

        <p>"Pretty large tables are running, only one server is used and everything works very fast — with any filters and sorting everything is almost instant."</p>

        <p>Bioinformatics - evolutionary genetics:
        <br/><a href="https://github.com/msestak/FindOrigin">https://github.com/msestak/FindOrigin</a></p>

        <p>"We are exploring evolution of novel genes in genomes because it seems that genomes are far from being static as previously believed and what actually happens is that new genes are constantly being added and old genes are lost."</p>

        <p>LHCb experiment at LHC:
        <br/><a href="https://www.yandex.com/company/press_center/press_releases/2012/2012-04-10/">https://www.yandex.com/company/press_center/press_releases/2012/2012-04-10/</a></p>
    </section>

<!-- Performance -->

    <section class="slide">
        <h1 style="margin-top: 200px"><span>Why Is ClickHouse So Fast?</span></h1>
    </section>


    <section class="slide">
        <h2>Why Is ClickHouse So Fast?</h2>
        <p>&nbsp;</p>
        <p style="font-size: 40px;">&mdash; out of necessity.</p>
        <p style="font-size: 40px;">Yandex.Metrica must work.</p>
    </section>

    <section class="slide">
        <h2>Why Is ClickHouse So Fast?</h2>
        <p>To quickly process an analytical query, the system must:<br/>&nbsp;</p>
        <p style="font-size: 40px;">1. Read quickly.</p>
        <p style="font-size: 40px;">2. Compute quickly.</p>
    </section>

    <section class="slide">
        <h2>Why Is ClickHouse So Fast?</h2>
        <p style="font-size: 40px;">1. Read quickly.</p>

        <p>&ndash; locality by primary key;
        <br/>&ndash; columns - we read only what's needed;
        <br/>&ndash; strong typing;
        <br/>&ndash; data compression.</p>

        <p style="font-size: 40px;">2. Compute quickly.</p>

        <p>&ndash; vectorized engine;
        <br/>&ndash; specialization of data structures;
        <br/>&ndash; low-level optimizations.</p>
    </section>

    <section class="slide">
        <h2>Why Is ClickHouse So Fast?</h2>
        <p><b>Algorithmic optimization.</b></p>
        <p>MergeTree, data locality on disk<br/>— fast range queries.</p>
        <p>Example: the uniqCombined function consists of a combination of three different data structures, suitable for different cardinality ranges.</p>
        <p><b>Low-level optimization.</b></p>
        <p>Example: vectorized query execution.</p>
        <p><b>Specialization and attention to detail.</b></p>
        <p>Example: we have 17 different algorithms for executing GROUP BY. The best one is chosen for your query.</p>
    </section>

<!-- Benchmarks -->

<section class="slide">
    <h2>Independent Benchmarks</h2>
    <p>ClickHouse vs. Spark &amp; MariaDB Column Store</p>
    <p style="font-size: 12pt;">https://www.percona.com/blog/2017/02/13/clickhouse-new-opensource-columnar-database/</p>
    <img src="pictures/spark.png" style="height:60%"/>
</section>

<section class="slide">
    <h2>Independent Benchmarks</h2>
    <p>ClickHouse vs. Redshift</p>
    <p>https://www.altinity.com/blog/2017/6/20/clickhouse-vs-redshift</p>
    <img src="pictures/redshift.png" style="height:60%"/>
</section>

<section class="slide">
    <h2>ClickHouse vs. Greenplum</h2>
    <img src="pictures/greenplum.png" style="width:100%"/>
</section>

<section class="slide">
    <h2 style="font-size: 42px;">Significant Limitations of ClickHouse</h2>
    <p>Limited JOIN support</p>
    <p>No UPDATE, DELETE</p>
    <p>Weak SQL standard compatibility</p>
</section>

    <section class="slide">
        <h2>ClickHouse vs. Vertica</h2>
        <p>Timur Shenkao:<br /><br />&laquo;ClickHouse is extremely fast at simple SELECTs without joins, much faster than Vertica&raquo;.</p>
    </section>

    <section class="slide">
        <h2>ClickHouse vs. PrestoDB</h2>
        <p>Ömer Osman Koçak:<br /><br />
        &laquo;When we evaluated ClickHouse the results were great compared to Prestodb. Even though the columnar storage optimizations for ORC and Clickhouse is quite similar, Clickhouse uses CPU and Memory resources more efficiently (Presto also uses vectorized execution but cannot take advantage of hardware level optimizations such as SIMD instruction sets because it's written in Java so that's fair) so we also wanted to add support for Clickhouse for our open-source analytics platform Rakam (https://github.com/rakam-io/rakam)&raquo;</p>
    </section>

    <section class="slide">
        <h2>ClickHouse vs. Google BigQuery</h2>
        <p>&laquo;ClickHouse shows comparable speed on <u>this query</u> for 30 days and 8 times faster (!) on <u>this query</u>. We plan to test other queries as well, haven't gotten to it yet.<br/><br/>Query execution speed is stable. In Google BigQuery during peak loads, for example at 4:00 p.m. PDT or at the beginning of the month, query execution time can noticeably increase&raquo;.</p>
    </section>

    <section class="slide">
        <h2>ClickHouse vs. Druid</h2>
        <p>&laquo;This year we deployed a Druid-based build — Imply Analytics Platform, as well as Tranquility, and were ready to launch into production… But after ClickHouse came out, we immediately abandoned Druid, even though we spent two months studying and implementing it&raquo;.</p>
        <p><a href="https://habrahabr.ru/company/smi2/blog/314558/">https://habrahabr.ru/company/smi2/blog/314558/</a></p>
    </section>

    <section class="slide">
        <h2>ClickHouse vs. InfiniDB</h2>
        <p>&laquo;结论：clickhouse速度更快！&raquo;</p>
        <p>&laquo;In conclusion, ClickHouse is faster!&raquo;</p>
        <p><a href="http://verynull.com/2016/08/22/infinidb与clickhouse对比/">http://verynull.com/2016/08/22/infinidb与clickhouse对比/</a></p>
        <p><img src="pictures/infinidb_cn.png" style="width:100%"/></p>
    </section>

<!-- Interfaces -->

<section class="slide">
    <h2>Interfaces</h2>
    <p style="font-size: 30px;">HTTP REST</p>
    <p style="font-size: 30px;">clickhouse-client</p>
    <p style="font-size: 30px;">JDBC (production), ODBC (beta)</p>
    <p>&nbsp;</p>
    <p style="font-size: 30px;">Python, PHP, Perl, Go,<br/>Node.js, Ruby, C++, .NET, Scala, R, Julia, Rust</p>
</section>

<section class="slide">
    <h2 style="font-size: 32px;">Integration with Data Visualization Systems</h2>
    <p style="font-size: 30px;">Tabix (tabix.io) &mdash; developed specifically for ClickHouse.</p>
    <p style="font-size: 30px;"><img style="float: left; padding-right: 20px;" src="pictures/tabix.gif" width="300" />And also:<br/><br/>Grafana, Redash, Apache Zeppelin,<br/>Superset, Power&nbsp;BI&hellip;</p>
</section>

<section class="slide">
    <h2 style="font-size: 32px;">PostgreSQL Integration</h2>
    <p>FDW for PostgreSQL from Infinidat<br/>(based on Multicorn)</p>
    <p>Connecting external dictionary tables from PostgreSQL<br/>using ODBC data source</p>
</section>


    <section class="slide">
        <h2><span>Community</span></h2>
        <p><span>Website: <a href="https://clickhouse.com/">https://clickhouse.com/</a></span></p>
        <p><span>Google groups: <a href="https://groups.google.com/forum/#!forum/clickhouse">https://groups.google.com/forum/#!forum/clickhouse</a></span></p>
        <p><span>Mailing list: clickhouse-feedback@yandex-team.com</span></p>
        <p><span>Telegram chat: <a href="https://telegram.me/clickhouse_en">https://telegram.me/clickhouse_en</a> and <a href="https://telegram.me/clickhouse_ru">https://telegram.me/clickhouse_ru</a> (already 805 members)</span></p>
        <p><span>GitHub: <a href="https://github.com/ClickHouse/ClickHouse/">https://github.com/ClickHouse/ClickHouse/</a></span></p>
        <p>&nbsp;</p>
        <p><span>+ meetups. Moscow, St. Petersburg, Novosibirsk,<br/>Yekaterinburg, San Francisco, Minsk... Next: Nizhny Novgorod, Kazan, Berlin...</span></p>
    </section>

    <section class="slide">
        <h2><span>?</span></h2>
    </section>

    <div class="progress"></div>
    <script src="shower/shower.min.js"></script>
</body>
</html>
